!function(){var t,e={};"use strict";e=function(){var t;function e(t){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");console.log(t),this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.handleKeyDown=this.handleKeyDown.bind(this),this.hasStarted=!1}return t=[{key:"startToRestart",value:function(){if(!this.hasStarted){var t=document.querySelector(".start");t.textContent="Restart",t.classList.remove("start"),t.classList.add("restart"),this.hasStarted=!0}}},{key:"updateScore",value:function(){var t=document.querySelector(".game-score");t&&(t.textContent=this.score)}},{key:"handleKeyDown",value:function(t){"lose"!==this.status&&"win"!==this.status&&("ArrowLeft"===t.code&&this.moveLeft(),"ArrowRight"===t.code&&this.moveRight(),"ArrowUp"===t.code&&this.moveUp(),"ArrowDown"===t.code&&this.moveDown())}},{key:"setupControls",value:function(){this.controlsSet||(document.addEventListener("keydown",this.handleKeyDown),this.controlsSet=!0)}},{key:"addRandomTile",value:function(){for(var t=[],e=0;e<this.board.length;e++)for(var r=0;r<this.board[e].length;r++)0===this.board[e][r]&&t.push([e,r]);if(t.length>0){var s=Math.floor(Math.random()*t.length),a=.9>Math.random()?2:4;this.board[t[s][0]][t[s][1]]=a}}},{key:"moveLeft",value:function(){for(var t=JSON.stringify(this.board),e=0;e<this.board.length;e++){for(var r=[],s=0;s<this.board[e].length;s++)0!==this.board[e][s]&&r.push(this.board[e][s]);for(var a=0;a<r.length;a++)r[a]===r[a+1]&&(r[a]*=2,r.splice(a+1,1),this.score+=r[a],r.push(0),a++);for(;r.length<this.board[e].length;)r.push(0);this.board[e]=r}t!==JSON.stringify(this.board)&&this.addRandomTile(),this.getStatus(),this.render(),this.updateScore(),this.startToRestart()}},{key:"moveRight",value:function(){for(var t=JSON.stringify(this.board),e=0;e<this.board.length;e++){for(var r=this.board[e].filter(function(t){return 0!==t}).reverse(),s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,this.score+=r[s],r.splice(s+1,1));for(;r.length<4;)r.push(0);this.board[e]=r.reverse()}t!==JSON.stringify(this.board)&&this.addRandomTile(),this.getStatus(),this.render(),this.updateScore(),this.startToRestart()}},{key:"moveUp",value:function(){for(var t=JSON.stringify(this.board),e=0;e<this.board[0].length;e++){for(var r=[],s=0;s<this.board.length;s++)0!==this.board[s][e]&&r.push(this.board[s][e]);for(var a=0;a<r.length;a++)r[a]===r[a+1]&&(r[a]*=2,r.splice(a+1,1),this.score+=r[a],r.push(0),a++);for(;r.length<this.board.length;)r.push(0);for(var o=0;o<this.board.length;o++)this.board[o][e]=r[o]}t!==JSON.stringify(this.board)&&this.addRandomTile(),this.getStatus(),this.render(),this.updateScore(),this.startToRestart()}},{key:"moveDown",value:function(){for(var t=JSON.stringify(this.board),e=0;e<this.board[0].length;e++){for(var r=[],s=this.board.length-1;s>=0;s--)0!==this.board[s][e]&&r.push(this.board[s][e]);for(var a=0;a<r.length;a++)r[a]===r[a+1]&&(r[a]*=2,r.splice(a+1,1),this.score+=r[a],r.push(0),a++);for(;r.length<this.board.length;)r.push(0);for(var o=this.board.length-1;o>=0;o--)this.board[o][e]=r[this.board.length-1-o]}t!==JSON.stringify(this.board)&&this.addRandomTile(),this.getStatus(),this.render(),this.updateScore(),this.startToRestart()}},{key:"getScore",value:function(){return this.render(),this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){for(var t=0;t<this.board.length;t++)for(var e=0;e<this.board[t].length;e++){if(2048===this.board[t][e])return this.status="win",this.status;if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return this.status="playing",this.status}return this.status="lose",this.status}},{key:"start",value:function(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status="playing";for(var t,e,r=[],s=0;s<this.board.length;s++)for(var a=0;a<this.board[s].length;a++)0===this.board[s][a]&&r.push([s,a]);do t=Math.floor(Math.random()*r.length),e=Math.floor(Math.random()*r.length);while(t===e)var o=.9>Math.random()?2:4;this.board[r[t][0]][r[t][1]]=o;var i=.9>Math.random()?2:4;this.board[r[e][0]][r[e][1]]=i,this.setupControls(),this.render()}},{key:"restart",value:function(){this.score=0,this.updateScore(),this.start()}},{key:"renderCell",value:function(t,e){t.className="field-cell",0!==e?(t.classList.add("field-cell--".concat(e)),t.textContent=e):t.textContent=""}},{key:"render",value:function(){for(var t=this,e=document.querySelectorAll(".field-cell"),r=0;r<this.board.length;r++)for(var s=0;s<this.board.length;s++){var a=r*this.board.length+s,o=this.board[r][s];e[a].textContent=0===o?"":o}var i=document.querySelector(".score");i&&(i.textContent=this.score),document.querySelectorAll(".field-cell").forEach(function(e,r){var s=Math.floor(r/4),a=t.board[s][r%4];t.renderCell(e,a)});var h=document.querySelector(".message-win"),n=document.querySelector(".message-lose"),d=document.querySelector(".message-start");h&&("win"===this.status?h.classList.remove("hidden"):h.classList.add("hidden")),n&&("lose"===this.status?n.classList.remove("hidden"):n.classList.add("hidden")),d&&"idle"!==this.status&&d.classList.add("hidden")}}],function(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(e.prototype,t),e}();"use strict";var r=new((t=e)&&t.__esModule?t.default:t);document.querySelector(".start").addEventListener("click",function(){r.hasStarted?r.restart():r.start()})}();
//# sourceMappingURL=js_2048-game.701a999e.js.map
